[LONGITUDINAL]
input = {
  DIS1, Q1th1, Q1th2, Q1th3, 
  DIS2, Q2th1, Q2th2, Q2th3,
  DIS3, Q3th1, Q3th2, Q3th3,
  DIS4, Q4th1, Q4th2, Q4th3,
  DIS5, Q5th1, Q5th2, Q5th3,
  DIS6, Q6th1, Q6th2, Q6th3,
  DIS7, Q7th1, Q7th2, Q7th3,
  DIS8, Q8th1, Q8th2, Q8th3,
  DIS9, Q9th1, Q9th2, Q9th3,
  DIS10, Q10th1, Q10th2, Q10th3,
  DIS11, Q11th1, Q11th2, Q11th3,
  DIS12, Q12th1, Q12th2, Q12th3,
  DIS13, Q13th1, Q13th2, Q13th3,
  DIS14, Q14th1, Q14th2, Q14th3,
  DIS15, Q15th1, Q15th2, Q15th3,
  DIS16, Q16th1, Q16th2, Q16th3,
  DIS17, Q17th1, Q17th2, Q17th3,
  DIS18, Q18th1, Q18th2, Q18th3,
  DIS19, Q19th1, Q19th2, Q19th3,
  DIS20, Q20th1, Q20th2, Q20th3,
  DIS21, Q21th1, Q21th2, Q21th3,
  DIS22, Q22th1, Q22th2, Q22th3,
  DIS23, Q23th1, Q23th2, Q23th3,
  DIS24, Q24th1, Q24th2, Q24th3,
  DIS25, Q25th1, Q25th2, Q25th3,
  DIS26, Q26th1, Q26th2, Q26th3,
  DIS27, Q27th1, Q27th2, Q27th3,
  DIS28, Q28th1, Q28th2, Q28th3,
  DIS29, Q29th1, Q29th2, Q29th3,   
  DIS30, Q30th1, Q30th2, Q30th3,   
  BASEQL2, PROGQL2, HLQL2,
  BASEPF2, PROGPF2, HLPF2,
  BASERF2, PROGRF2, HLRF2,
  BASEEF, PROGEF, HLEF,
  BASECF, PROGCF, HLCF,
  BASESF, PROGSF, HLSF,
  BASEFA, PROGFA, HLFA,
  BASENV, PROGNV, HLNV,
  BASEPA, PROGPA, HLPA,
  BASEDY, PROGDY, HLDY,
  BASESL, PROGSL, HLSL,
  BASEAP, PROGAP, HLAP,
  BASECO, PROGCO, HLCO,
  BASEDI, PROGDI, HLDI,
  BASEFI, PROGFI, HLFI}


EQUATION:

; latent variable trajectories
QL2 = BASEQL2 + PROGQL2 * (1 - exp(-log(2)/HLQL2 * t)) ; GHS/QOL (item 29, 30)
PF2 = BASEPF2 + PROGPF2 * (1 - exp(-log(2)/HLPF2 * t)) ; Physical function (item 1 to 5)
RF2 = BASERF2 + PROGRF2 * (1 - exp(-log(2)/HLRF2 * t)) ; Role function (item 6,7)
EF = BASEEF + PROGEF * (1 - exp(-log(2)/HLEF * t)) ; Emotional function (item 21 to 24)
CF = BASECF + PROGCF * (1 - exp(-log(2)/HLCF * t)) ; Cognitive function (item 20, 25)
SF = BASESF + PROGSF * (1 - exp(-log(2)/HLSF * t)) ; Social function (item 26, 27)
FA = BASEFA + PROGFA * (1 - exp(-log(2)/HLFA * t)) ; Fatigue (item 10, 12, 18)
NV = BASENV + PROGNV * (1 - exp(-log(2)/HLNV * t)) ; Nausea/Vomit (item 14, 15)
PA = BASEPA + PROGPA * (1 - exp(-log(2)/HLPA * t)) ; Pain (item 9, 19)
DY = BASEDY + PROGDY * (1 - exp(-log(2)/HLDY * t)) ; Dyspnoea (item 8)
SL = BASESL + PROGSL * (1 - exp(-log(2)/HLSL * t)) ; Insomnia (item 11)
AP = BASEAP + PROGAP * (1 - exp(-log(2)/HLAP * t)) ; Appetite Loss (item 13)
CO = BASECO + PROGCO * (1 - exp(-log(2)/HLCO * t)) ; Constipation (item 16)
DI = BASEDI + PROGDI * (1 - exp(-log(2)/HLDI * t)) ; Diarrhea (item 17)
FI = BASEFI + PROGFI * (1 - exp(-log(2)/HLFI * t)) ; Financial Difficulty (item 28)

; Item-specific linear predictors
eta1 = PF2
eta2 = PF2
eta3 = PF2
eta4 = PF2
eta5 = PF2
eta6 = RF2
eta7 = RF2
eta8 = DY
eta9 = PA
eta10 = FA
eta11 = SL
eta12 = FA
eta13 = AP
eta14 = NV
eta15 = NV
eta16 = CO
eta17 = DI
eta18 = FA
eta19 = PA
eta20 = CF
eta21 = EF
eta22 = EF
eta23 = EF
eta24 = EF
eta25 = CF
eta26 = SF 
eta27 = SF 
eta28 = FI
eta29 = QL2
eta30 = QL2

; Define cumulative logits for each item
;-------------Item 1, Any trouble doing strenuous activities?------------
b1_1 = Q1th1
b1_2 = Q1th1 + Q1th2
b1_3 = Q1th1 + Q1th2 + Q1th3

p1_1DV = 1 - exp(DIS1*(eta1-b1_1))/(1+exp(DIS1*(eta1-b1_1)))
p1_2DV = exp(DIS1*(eta1-b1_1))/(1+exp(DIS1*(eta1-b1_1)))-exp(DIS1*(eta1-b1_2))/(1+exp(DIS1*(eta1-b1_2)))
p1_3DV = exp(DIS1*(eta1-b1_2))/(1+exp(DIS1*(eta1-b1_2)))-exp(DIS1*(eta1-b1_3))/(1+exp(DIS1*(eta1-b1_3)))
p1_4DV = exp(DIS1*(eta1-b1_3))/(1+exp(DIS1*(eta1-b1_3)))

; Add a range for probability
p1_1 = min(max(p1_1DV,0.0001),0.9999)
p1_2 = min(max(p1_2DV,0.0001),0.9999)
p1_3 = min(max(p1_3DV,0.0001),0.9999)
p1_4 = min(max(p1_4DV,0.0001),0.9999)

;-------------Item 2, Any trouble taking a long walk?------------
b2_1 = Q2th1
b2_2 = Q2th1 + Q2th2
b2_3 = Q2th1 + Q2th2 + Q2th3

p2_1DV = 1 - exp(DIS2*(eta2-b2_1))/(1+exp(DIS2*(eta2-b2_1)))
p2_2DV = exp(DIS2*(eta2-b2_1))/(1+exp(DIS2*(eta2-b2_1)))-exp(DIS2*(eta2-b2_2))/(1+exp(DIS2*(eta2-b2_2)))
p2_3DV = exp(DIS2*(eta2-b2_2))/(1+exp(DIS2*(eta2-b2_2)))-exp(DIS2*(eta2-b2_3))/(1+exp(DIS2*(eta2-b2_3)))
p2_4DV = exp(DIS2*(eta2-b2_3))/(1+exp(DIS2*(eta2-b2_3)))

; Add a range for probability
p2_1 = min(max(p2_1DV,0.0001),0.9999)
p2_2 = min(max(p2_2DV,0.0001),0.9999)
p2_3 = min(max(p2_3DV,0.0001),0.9999)
p2_4 = min(max(p2_4DV,0.0001),0.9999)

;-------------Item 3, Any trouble taking a short walk outside?------------
b3_1 = Q3th1
b3_2 = Q3th1 + Q3th2
b3_3 = Q3th1 + Q3th2 + Q3th3

p3_1DV = 1 - exp(DIS3*(eta3-b3_1))/(1+exp(DIS3*(eta3-b3_1)))
p3_2DV = exp(DIS3*(eta3-b3_1))/(1+exp(DIS3*(eta3-b3_1)))-exp(DIS3*(eta3-b3_2))/(1+exp(DIS3*(eta3-b3_2)))
p3_3DV = exp(DIS3*(eta3-b3_2))/(1+exp(DIS3*(eta3-b3_2)))-exp(DIS3*(eta3-b3_3))/(1+exp(DIS3*(eta3-b3_3)))
p3_4DV = exp(DIS3*(eta3-b3_3))/(1+exp(DIS3*(eta3-b3_3)))

; Add a range for probability
p3_1 = min(max(p3_1DV,0.0001),0.9999)
p3_2 = min(max(p3_2DV,0.0001),0.9999)
p3_3 = min(max(p3_3DV,0.0001),0.9999)
p3_4 = min(max(p3_4DV,0.0001),0.9999)

;-------------Item 4, do you need to stay in bed during the day?---------
b4_1 = Q4th1
b4_2 = Q4th1 + Q4th2
b4_3 = Q4th1 + Q4th2 + Q4th3

p4_1DV = 1 - exp(DIS4*(eta4-b4_1))/(1+exp(DIS4*(eta4-b4_1)))
p4_2DV = exp(DIS4*(eta4-b4_1))/(1+exp(DIS4*(eta4-b4_1)))-exp(DIS4*(eta4-b4_2))/(1+exp(DIS4*(eta4-b4_2)))
p4_3DV = exp(DIS4*(eta4-b4_2))/(1+exp(DIS4*(eta4-b4_2)))-exp(DIS4*(eta4-b4_3))/(1+exp(DIS4*(eta4-b4_3)))
p4_4DV = exp(DIS4*(eta4-b4_3))/(1+exp(DIS4*(eta4-b4_3)))

; Add a range for probability
p4_1 = min(max(p4_1DV,0.0001),0.9999)
p4_2 = min(max(p4_2DV,0.0001),0.9999)
p4_3 = min(max(p4_3DV,0.0001),0.9999)
p4_4 = min(max(p4_4DV,0.0001),0.9999)

;-------------Item 5, do you need help with eating/washing/dressing etc?---------
b5_1 = Q5th1
b5_2 = Q5th1 + Q5th2
b5_3 = Q5th1 + Q5th2 + Q5th3

p5_1DV = 1 - exp(DIS5*(eta5-b5_1))/(1+exp(DIS5*(eta5-b5_1)))
p5_2DV = exp(DIS5*(eta5-b5_1))/(1+exp(DIS5*(eta5-b5_1)))-exp(DIS5*(eta5-b5_2))/(1+exp(DIS5*(eta5-b5_2)))
p5_3DV = exp(DIS5*(eta5-b5_2))/(1+exp(DIS5*(eta5-b5_2)))-exp(DIS5*(eta5-b5_3))/(1+exp(DIS5*(eta5-b5_3)))
p5_4DV = exp(DIS5*(eta5-b5_3))/(1+exp(DIS5*(eta5-b5_3)))

; Add a range for probability
p5_1 = min(max(p5_1DV,0.0001),0.9999)
p5_2 = min(max(p5_2DV,0.0001),0.9999)
p5_3 = min(max(p5_3DV,0.0001),0.9999)
p5_4 = min(max(p5_4DV,0.0001),0.9999)


;-------------Item 6, were you limited in doing your work?---------
b6_1 = Q6th1
b6_2 = Q6th1 + Q6th2
b6_3 = Q6th1 + Q6th2 + Q6th3

p6_1DV = 1 - exp(DIS6*(eta6-b6_1))/(1+exp(DIS6*(eta6-b6_1)))
p6_2DV = exp(DIS6*(eta6-b6_1))/(1+exp(DIS6*(eta6-b6_1)))-exp(DIS6*(eta6-b6_2))/(1+exp(DIS6*(eta6-b6_2)))
p6_3DV = exp(DIS6*(eta6-b6_2))/(1+exp(DIS6*(eta6-b6_2)))-exp(DIS6*(eta6-b6_3))/(1+exp(DIS6*(eta6-b6_3)))
p6_4DV = exp(DIS6*(eta6-b6_3))/(1+exp(DIS6*(eta6-b6_3)))

; Add a range for probability
p6_1 = min(max(p6_1DV,0.0001),0.9999)
p6_2 = min(max(p6_2DV,0.0001),0.9999)
p6_3 = min(max(p6_3DV,0.0001),0.9999)
p6_4 = min(max(p6_4DV,0.0001),0.9999)


;-------------Item 7, were you limited in pursuing your hobbies?---------
b7_1 = Q7th1
b7_2 = Q7th1 + Q7th2
b7_3 = Q7th1 + Q7th2 + Q7th3

p7_1DV = 1 - exp(DIS7*(eta7-b7_1))/(1+exp(DIS7*(eta7-b7_1)))
p7_2DV = exp(DIS7*(eta7-b7_1))/(1+exp(DIS7*(eta7-b7_1)))-exp(DIS7*(eta7-b7_2))/(1+exp(DIS7*(eta7-b7_2)))
p7_3DV = exp(DIS7*(eta7-b7_2))/(1+exp(DIS7*(eta7-b7_2)))-exp(DIS7*(eta7-b7_3))/(1+exp(DIS7*(eta7-b7_3)))
p7_4DV = exp(DIS7*(eta7-b7_3))/(1+exp(DIS7*(eta7-b7_3)))

; Add a range for probability
p7_1 = min(max(p7_1DV,0.0001),0.9999)
p7_2 = min(max(p7_2DV,0.0001),0.9999)
p7_3 = min(max(p7_3DV,0.0001),0.9999)
p7_4 = min(max(p7_4DV,0.0001),0.9999)

;-------------Item 8, were you short of breath?---------
b8_1 = Q8th1
b8_2 = Q8th1 + Q8th2
b8_3 = Q8th1 + Q8th2 + Q8th3

p8_1DV = 1 - exp(DIS8*(eta8-b8_1))/(1+exp(DIS8*(eta8-b8_1)))
p8_2DV = exp(DIS8*(eta8-b8_1))/(1+exp(DIS8*(eta8-b8_1)))-exp(DIS8*(eta8-b8_2))/(1+exp(DIS8*(eta8-b8_2)))
p8_3DV = exp(DIS8*(eta8-b8_2))/(1+exp(DIS8*(eta8-b8_2)))-exp(DIS8*(eta8-b8_3))/(1+exp(DIS8*(eta8-b8_3)))
p8_4DV = exp(DIS8*(eta8-b8_3))/(1+exp(DIS8*(eta8-b8_3)))

; Add a range for probability
p8_1 = min(max(p8_1DV,0.0001),0.9999)
p8_2 = min(max(p8_2DV,0.0001),0.9999)
p8_3 = min(max(p8_3DV,0.0001),0.9999)
p8_4 = min(max(p8_4DV,0.0001),0.9999)

;-------------Item 9, Have you had pain?---------
b9_1 = Q9th1
b9_2 = Q9th1 + Q9th2
b9_3 = Q9th1 + Q9th2 + Q9th3

p9_1DV = 1 - exp(DIS9*(eta9-b9_1))/(1+exp(DIS9*(eta9-b9_1)))
p9_2DV = exp(DIS9*(eta9-b9_1))/(1+exp(DIS9*(eta9-b9_1)))-exp(DIS9*(eta9-b9_2))/(1+exp(DIS9*(eta9-b9_2)))
p9_3DV = exp(DIS9*(eta9-b9_2))/(1+exp(DIS9*(eta9-b9_2)))-exp(DIS9*(eta9-b9_3))/(1+exp(DIS9*(eta9-b9_3)))
p9_4DV = exp(DIS9*(eta9-b9_3))/(1+exp(DIS9*(eta9-b9_3)))

; Add a range for probability
p9_1 = min(max(p9_1DV,0.0001),0.9999)
p9_2 = min(max(p9_2DV,0.0001),0.9999)
p9_3 = min(max(p9_3DV,0.0001),0.9999)
p9_4 = min(max(p9_4DV,0.0001),0.9999)

;-------------Item 10, Did you need to rest?---------
b10_1 = Q10th1
b10_2 = Q10th1 + Q10th2
b10_3 = Q10th1 + Q10th2 + Q10th3

p10_1DV = 1 - exp(DIS10*(eta10-b10_1))/(1+exp(DIS10*(eta10-b10_1)))
p10_2DV = exp(DIS10*(eta10-b10_1))/(1+exp(DIS10*(eta10-b10_1)))-exp(DIS10*(eta10-b10_2))/(1+exp(DIS10*(eta10-b10_2)))
p10_3DV = exp(DIS10*(eta10-b10_2))/(1+exp(DIS10*(eta10-b10_2)))-exp(DIS10*(eta10-b10_3))/(1+exp(DIS10*(eta10-b10_3)))
p10_4DV = exp(DIS10*(eta10-b10_3))/(1+exp(DIS10*(eta10-b10_3)))

; Add a range for probability
p10_1 = min(max(p10_1DV,0.0001),0.9999)
p10_2 = min(max(p10_2DV,0.0001),0.9999)
p10_3 = min(max(p10_3DV,0.0001),0.9999)
p10_4 = min(max(p10_4DV,0.0001),0.9999)

;-------------Item 11, Have you had trouble sleeping?---------
b11_1 = Q11th1
b11_2 = Q11th1 + Q11th2
b11_3 = Q11th1 + Q11th2 + Q11th3

p11_1DV = 1 - exp(DIS11*(eta11-b11_1))/(1+exp(DIS11*(eta11-b11_1)))
p11_2DV = exp(DIS11*(eta11-b11_1))/(1+exp(DIS11*(eta11-b11_1)))-exp(DIS11*(eta11-b11_2))/(1+exp(DIS11*(eta11-b11_2)))
p11_3DV = exp(DIS11*(eta11-b11_2))/(1+exp(DIS11*(eta11-b11_2)))-exp(DIS11*(eta11-b11_3))/(1+exp(DIS11*(eta11-b11_3)))
p11_4DV = exp(DIS11*(eta11-b11_3))/(1+exp(DIS11*(eta11-b11_3)))

; Add a range for probability
p11_1 = min(max(p11_1DV,0.0001),0.9999)
p11_2 = min(max(p11_2DV,0.0001),0.9999)
p11_3 = min(max(p11_3DV,0.0001),0.9999)
p11_4 = min(max(p11_4DV,0.0001),0.9999)

;-------------Item 12, Have you felt weak?---------
b12_1 = Q12th1
b12_2 = Q12th1 + Q12th2
b12_3 = Q12th1 + Q12th2 + Q12th3

p12_1DV = 1 - exp(DIS12*(eta12-b12_1))/(1+exp(DIS12*(eta12-b12_1)))
p12_2DV = exp(DIS12*(eta12-b12_1))/(1+exp(DIS12*(eta12-b12_1)))-exp(DIS12*(eta12-b12_2))/(1+exp(DIS12*(eta12-b12_2)))
p12_3DV = exp(DIS12*(eta12-b12_2))/(1+exp(DIS12*(eta12-b12_2)))-exp(DIS12*(eta12-b12_3))/(1+exp(DIS12*(eta12-b12_3)))
p12_4DV = exp(DIS12*(eta12-b12_3))/(1+exp(DIS12*(eta12-b12_3)))

; Add a range for probability
p12_1 = min(max(p12_1DV,0.0001),0.9999)
p12_2 = min(max(p12_2DV,0.0001),0.9999)
p12_3 = min(max(p12_3DV,0.0001),0.9999)
p12_4 = min(max(p12_4DV,0.0001),0.9999)

;-------------Item 13, Have you lacked appetite?---------
b13_1 = Q13th1
b13_2 = Q13th1 + Q13th2
b13_3 = Q13th1 + Q13th2 + Q13th3

p13_1DV = 1 - exp(DIS13*(eta13-b13_1))/(1+exp(DIS13*(eta13-b13_1)))
p13_2DV = exp(DIS13*(eta13-b13_1))/(1+exp(DIS13*(eta13-b13_1)))-exp(DIS13*(eta13-b13_2))/(1+exp(DIS13*(eta13-b13_2)))
p13_3DV = exp(DIS13*(eta13-b13_2))/(1+exp(DIS13*(eta13-b13_2)))-exp(DIS13*(eta13-b13_3))/(1+exp(DIS13*(eta13-b13_3)))
p13_4DV = exp(DIS13*(eta13-b13_3))/(1+exp(DIS13*(eta13-b13_3)))

; Add a range for probability
p13_1 = min(max(p13_1DV,0.0001),0.9999)
p13_2 = min(max(p13_2DV,0.0001),0.9999)
p13_3 = min(max(p13_3DV,0.0001),0.9999)
p13_4 = min(max(p13_4DV,0.0001),0.9999)

;-------------Item 14, Have you felt nauseated?---------
b14_1 = Q14th1
b14_2 = Q14th1 + Q14th2
b14_3 = Q14th1 + Q14th2 + Q14th3

p14_1DV = 1 - exp(DIS14*(eta14-b14_1))/(1+exp(DIS14*(eta14-b14_1)))
p14_2DV = exp(DIS14*(eta14-b14_1))/(1+exp(DIS14*(eta14-b14_1)))-exp(DIS14*(eta14-b14_2))/(1+exp(DIS14*(eta14-b14_2)))
p14_3DV = exp(DIS14*(eta14-b14_2))/(1+exp(DIS14*(eta14-b14_2)))-exp(DIS14*(eta14-b14_3))/(1+exp(DIS14*(eta14-b14_3)))
p14_4DV = exp(DIS14*(eta14-b14_3))/(1+exp(DIS14*(eta14-b14_3)))

; Add a range for probability
p14_1 = min(max(p14_1DV,0.0001),0.9999)
p14_2 = min(max(p14_2DV,0.0001),0.9999)
p14_3 = min(max(p14_3DV,0.0001),0.9999)
p14_4 = min(max(p14_4DV,0.0001),0.9999)

;-------------Item 15, Have you vomited?---------
b15_1 = Q15th1
b15_2 = Q15th1 + Q15th2
b15_3 = Q15th1 + Q15th2 + Q15th3

p15_1DV = 1 - exp(DIS15*(eta15-b15_1))/(1+exp(DIS15*(eta15-b15_1)))
p15_2DV = exp(DIS15*(eta15-b15_1))/(1+exp(DIS15*(eta15-b15_1)))-exp(DIS15*(eta15-b15_2))/(1+exp(DIS15*(eta15-b15_2)))
p15_3DV = exp(DIS15*(eta15-b15_2))/(1+exp(DIS15*(eta15-b15_2)))-exp(DIS15*(eta15-b15_3))/(1+exp(DIS15*(eta15-b15_3)))
p15_4DV = exp(DIS15*(eta15-b15_3))/(1+exp(DIS15*(eta15-b15_3)))

; Add a range for probability
p15_1 = min(max(p15_1DV,0.0001),0.9999)
p15_2 = min(max(p15_2DV,0.0001),0.9999)
p15_3 = min(max(p15_3DV,0.0001),0.9999)
p15_4 = min(max(p15_4DV,0.0001),0.9999)

;-------------Item 16, Have you been constipated?---------
b16_1 = Q16th1
b16_2 = Q16th1 + Q16th2
b16_3 = Q16th1 + Q16th2 + Q16th3

p16_1DV = 1 - exp(DIS16*(eta16-b16_1))/(1+exp(DIS16*(eta16-b16_1)))
p16_2DV = exp(DIS16*(eta16-b16_1))/(1+exp(DIS16*(eta16-b16_1)))-exp(DIS16*(eta16-b16_2))/(1+exp(DIS16*(eta16-b16_2)))
p16_3DV = exp(DIS16*(eta16-b16_2))/(1+exp(DIS16*(eta16-b16_2)))-exp(DIS16*(eta16-b16_3))/(1+exp(DIS16*(eta16-b16_3)))
p16_4DV = exp(DIS16*(eta16-b16_3))/(1+exp(DIS16*(eta16-b16_3)))

; Add a range for probability
p16_1 = min(max(p16_1DV,0.0001),0.9999)
p16_2 = min(max(p16_2DV,0.0001),0.9999)
p16_3 = min(max(p16_3DV,0.0001),0.9999)
p16_4 = min(max(p16_4DV,0.0001),0.9999)

;-------------Item 17, Have you had diarrhea?---------
b17_1 = Q17th1
b17_2 = Q17th1 + Q17th2
b17_3 = Q17th1 + Q17th2 + Q17th3

p17_1DV = 1 - exp(DIS17*(eta17-b17_1))/(1+exp(DIS17*(eta17-b17_1)))
p17_2DV = exp(DIS17*(eta17-b17_1))/(1+exp(DIS17*(eta17-b17_1)))-exp(DIS17*(eta17-b17_2))/(1+exp(DIS17*(eta17-b17_2)))
p17_3DV = exp(DIS17*(eta17-b17_2))/(1+exp(DIS17*(eta17-b17_2)))-exp(DIS17*(eta17-b17_3))/(1+exp(DIS17*(eta17-b17_3)))
p17_4DV = exp(DIS17*(eta17-b17_3))/(1+exp(DIS17*(eta17-b17_3)))

; Add a range for probability
p17_1 = min(max(p17_1DV,0.0001),0.9999)
p17_2 = min(max(p17_2DV,0.0001),0.9999)
p17_3 = min(max(p17_3DV,0.0001),0.9999)
p17_4 = min(max(p17_4DV,0.0001),0.9999)

;-------------Item 18, were you tired?---------
b18_1 = Q18th1
b18_2 = Q18th1 + Q18th2
b18_3 = Q18th1 + Q18th2 + Q18th3

p18_1DV = 1 - exp(DIS18*(eta18-b18_1))/(1+exp(DIS18*(eta18-b18_1)))
p18_2DV = exp(DIS18*(eta18-b18_1))/(1+exp(DIS18*(eta18-b18_1)))-exp(DIS18*(eta18-b18_2))/(1+exp(DIS18*(eta18-b18_2)))
p18_3DV = exp(DIS18*(eta18-b18_2))/(1+exp(DIS18*(eta18-b18_2)))-exp(DIS18*(eta18-b18_3))/(1+exp(DIS18*(eta18-b18_3)))
p18_4DV = exp(DIS18*(eta18-b18_3))/(1+exp(DIS18*(eta18-b18_3)))

; Add a range for probability
p18_1 = min(max(p18_1DV,0.0001),0.9999)
p18_2 = min(max(p18_2DV,0.0001),0.9999)
p18_3 = min(max(p18_3DV,0.0001),0.9999)
p18_4 = min(max(p18_4DV,0.0001),0.9999)

;-------------Item 19, did pain interfere with your daily activity?---------
b19_1 = Q19th1
b19_2 = Q19th1 + Q19th2
b19_3 = Q19th1 + Q19th2 + Q19th3

p19_1DV = 1 - exp(DIS19*(eta19-b19_1))/(1+exp(DIS19*(eta19-b19_1)))
p19_2DV = exp(DIS19*(eta19-b19_1))/(1+exp(DIS19*(eta19-b19_1)))-exp(DIS19*(eta19-b19_2))/(1+exp(DIS19*(eta19-b19_2)))
p19_3DV = exp(DIS19*(eta19-b19_2))/(1+exp(DIS19*(eta19-b19_2)))-exp(DIS19*(eta19-b19_3))/(1+exp(DIS19*(eta19-b19_3)))
p19_4DV = exp(DIS19*(eta19-b19_3))/(1+exp(DIS19*(eta19-b19_3)))

; Add a range for probability
p19_1 = min(max(p19_1DV,0.0001),0.9999)
p19_2 = min(max(p19_2DV,0.0001),0.9999)
p19_3 = min(max(p19_3DV,0.0001),0.9999)
p19_4 = min(max(p19_4DV,0.0001),0.9999)

;-------------Item 20, have you had difficulty concentrating?---------
b20_1 = Q20th1
b20_2 = Q20th1 + Q20th2
b20_3 = Q20th1 + Q20th2 + Q20th3

p20_1DV = 1 - exp(DIS20*(eta20-b20_1))/(1+exp(DIS20*(eta20-b20_1)))
p20_2DV = exp(DIS20*(eta20-b20_1))/(1+exp(DIS20*(eta20-b20_1)))-exp(DIS20*(eta20-b20_2))/(1+exp(DIS20*(eta20-b20_2)))
p20_3DV = exp(DIS20*(eta20-b20_2))/(1+exp(DIS20*(eta20-b20_2)))-exp(DIS20*(eta20-b20_3))/(1+exp(DIS20*(eta20-b20_3)))
p20_4DV = exp(DIS20*(eta20-b20_3))/(1+exp(DIS20*(eta20-b20_3)))

; Add a range for probability
p20_1 = min(max(p20_1DV,0.0001),0.9999)
p20_2 = min(max(p20_2DV,0.0001),0.9999)
p20_3 = min(max(p20_3DV,0.0001),0.9999)
p20_4 = min(max(p20_4DV,0.0001),0.9999)

;-------------Item 21, did you feel tense?---------
b21_1 = Q21th1
b21_2 = Q21th1 + Q21th2
b21_3 = Q21th1 + Q21th2 + Q21th3

p21_1DV = 1 - exp(DIS21*(eta21-b21_1))/(1+exp(DIS21*(eta21-b21_1)))
p21_2DV = exp(DIS21*(eta21-b21_1))/(1+exp(DIS21*(eta21-b21_1)))-exp(DIS21*(eta21-b21_2))/(1+exp(DIS21*(eta21-b21_2)))
p21_3DV = exp(DIS21*(eta21-b21_2))/(1+exp(DIS21*(eta21-b21_2)))-exp(DIS21*(eta21-b21_3))/(1+exp(DIS21*(eta21-b21_3)))
p21_4DV = exp(DIS21*(eta21-b21_3))/(1+exp(DIS21*(eta21-b21_3)))

; Add a range for probability
p21_1 = min(max(p21_1DV,0.0001),0.9999)
p21_2 = min(max(p21_2DV,0.0001),0.9999)
p21_3 = min(max(p21_3DV,0.0001),0.9999)
p21_4 = min(max(p21_4DV,0.0001),0.9999)

;-------------Item 22, did you worry?---------
b22_1 = Q22th1
b22_2 = Q22th1 + Q22th2
b22_3 = Q22th1 + Q22th2 + Q22th3

p22_1DV = 1 - exp(DIS22*(eta22-b22_1))/(1+exp(DIS22*(eta22-b22_1)))
p22_2DV = exp(DIS22*(eta22-b22_1))/(1+exp(DIS22*(eta22-b22_1)))-exp(DIS22*(eta22-b22_2))/(1+exp(DIS22*(eta22-b22_2)))
p22_3DV = exp(DIS22*(eta22-b22_2))/(1+exp(DIS22*(eta22-b22_2)))-exp(DIS22*(eta22-b22_3))/(1+exp(DIS22*(eta22-b22_3)))
p22_4DV = exp(DIS22*(eta22-b22_3))/(1+exp(DIS22*(eta22-b22_3)))

; Add a range for probability
p22_1 = min(max(p22_1DV,0.0001),0.9999)
p22_2 = min(max(p22_2DV,0.0001),0.9999)
p22_3 = min(max(p22_3DV,0.0001),0.9999)
p22_4 = min(max(p22_4DV,0.0001),0.9999)

;-------------Item 23, did you feel irritable?---------
b23_1 = Q23th1
b23_2 = Q23th1 + Q23th2
b23_3 = Q23th1 + Q23th2 + Q23th3

p23_1DV = 1 - exp(DIS23*(eta23-b23_1))/(1+exp(DIS23*(eta23-b23_1)))
p23_2DV = exp(DIS23*(eta23-b23_1))/(1+exp(DIS23*(eta23-b23_1)))-exp(DIS23*(eta23-b23_2))/(1+exp(DIS23*(eta23-b23_2)))
p23_3DV = exp(DIS23*(eta23-b23_2))/(1+exp(DIS23*(eta23-b23_2)))-exp(DIS23*(eta23-b23_3))/(1+exp(DIS23*(eta23-b23_3)))
p23_4DV = exp(DIS23*(eta23-b23_3))/(1+exp(DIS23*(eta23-b23_3)))

; Add a range for probability
p23_1 = min(max(p23_1DV,0.0001),0.9999)
p23_2 = min(max(p23_2DV,0.0001),0.9999)
p23_3 = min(max(p23_3DV,0.0001),0.9999)
p23_4 = min(max(p23_4DV,0.0001),0.9999)

;-------------Item 24, did you feel depressed?---------
b24_1 = Q24th1
b24_2 = Q24th1 + Q24th2
b24_3 = Q24th1 + Q24th2 + Q24th3

p24_1DV = 1 - exp(DIS24*(eta24-b24_1))/(1+exp(DIS24*(eta24-b24_1)))
p24_2DV = exp(DIS24*(eta24-b24_1))/(1+exp(DIS24*(eta24-b24_1)))-exp(DIS24*(eta24-b24_2))/(1+exp(DIS24*(eta24-b24_2)))
p24_3DV = exp(DIS24*(eta24-b24_2))/(1+exp(DIS24*(eta24-b24_2)))-exp(DIS24*(eta24-b24_3))/(1+exp(DIS24*(eta24-b24_3)))
p24_4DV = exp(DIS24*(eta24-b24_3))/(1+exp(DIS24*(eta24-b24_3)))

; Add a range for probability
p24_1 = min(max(p24_1DV,0.0001),0.9999)
p24_2 = min(max(p24_2DV,0.0001),0.9999)
p24_3 = min(max(p24_3DV,0.0001),0.9999)
p24_4 = min(max(p24_4DV,0.0001),0.9999)

;-------------Item 25, have you had difficulty remembering things?---------
b25_1 = Q25th1
b25_2 = Q25th1 + Q25th2
b25_3 = Q25th1 + Q25th2 + Q25th3

p25_1DV = 1 - exp(DIS25*(eta25-b25_1))/(1+exp(DIS25*(eta25-b25_1)))
p25_2DV = exp(DIS25*(eta25-b25_1))/(1+exp(DIS25*(eta25-b25_1)))-exp(DIS25*(eta25-b25_2))/(1+exp(DIS25*(eta25-b25_2)))
p25_3DV = exp(DIS25*(eta25-b25_2))/(1+exp(DIS25*(eta25-b25_2)))-exp(DIS25*(eta25-b25_3))/(1+exp(DIS25*(eta25-b25_3)))
p25_4DV = exp(DIS25*(eta25-b25_3))/(1+exp(DIS25*(eta25-b25_3)))

; Add a range for probability
p25_1 = min(max(p25_1DV,0.0001),0.9999)
p25_2 = min(max(p25_2DV,0.0001),0.9999)
p25_3 = min(max(p25_3DV,0.0001),0.9999)
p25_4 = min(max(p25_4DV,0.0001),0.9999)

;-------------Item 26, have you had physical condition interfered family life?---------
b26_1 = Q26th1
b26_2 = Q26th1 + Q26th2
b26_3 = Q26th1 + Q26th2 + Q26th3

p26_1DV = 1 - exp(DIS26*(eta26-b26_1))/(1+exp(DIS26*(eta26-b26_1)))
p26_2DV = exp(DIS26*(eta26-b26_1))/(1+exp(DIS26*(eta26-b26_1)))-exp(DIS26*(eta26-b26_2))/(1+exp(DIS26*(eta26-b26_2)))
p26_3DV = exp(DIS26*(eta26-b26_2))/(1+exp(DIS26*(eta26-b26_2)))-exp(DIS26*(eta26-b26_3))/(1+exp(DIS26*(eta26-b26_3)))
p26_4DV = exp(DIS26*(eta26-b26_3))/(1+exp(DIS26*(eta26-b26_3)))

; Add a range for probability
p26_1 = min(max(p26_1DV,0.0001),0.9999)
p26_2 = min(max(p26_2DV,0.0001),0.9999)
p26_3 = min(max(p26_3DV,0.0001),0.9999)
p26_4 = min(max(p26_4DV,0.0001),0.9999)

;-------------Item 27, have you had physical condition interfered social activity?---------
b27_1 = Q27th1
b27_2 = Q27th1 + Q27th2
b27_3 = Q27th1 + Q27th2 + Q27th3

p27_1DV = 1 - exp(DIS27*(eta27-b27_1))/(1+exp(DIS27*(eta27-b27_1)))
p27_2DV = exp(DIS27*(eta27-b27_1))/(1+exp(DIS27*(eta27-b27_1)))-exp(DIS27*(eta27-b27_2))/(1+exp(DIS27*(eta27-b27_2)))
p27_3DV = exp(DIS27*(eta27-b27_2))/(1+exp(DIS27*(eta27-b27_2)))-exp(DIS27*(eta27-b27_3))/(1+exp(DIS27*(eta27-b27_3)))
p27_4DV = exp(DIS27*(eta27-b27_3))/(1+exp(DIS27*(eta27-b27_3)))

; Add a range for probability
p27_1 = min(max(p27_1DV,0.0001),0.9999)
p27_2 = min(max(p27_2DV,0.0001),0.9999)
p27_3 = min(max(p27_3DV,0.0001),0.9999)
p27_4 = min(max(p27_4DV,0.0001),0.9999)

;-------------Item 28, have you had physical condition interfered financial difficulty?---------
b28_1 = Q28th1
b28_2 = Q28th1 + Q28th2
b28_3 = Q28th1 + Q28th2 + Q28th3

p28_1DV = 1 - exp(DIS28*(eta28-b28_1))/(1+exp(DIS28*(eta28-b28_1)))
p28_2DV = exp(DIS28*(eta28-b28_1))/(1+exp(DIS28*(eta28-b28_1)))-exp(DIS28*(eta28-b28_2))/(1+exp(DIS28*(eta28-b28_2)))
p28_3DV = exp(DIS28*(eta28-b28_2))/(1+exp(DIS28*(eta28-b28_2)))-exp(DIS28*(eta28-b28_3))/(1+exp(DIS28*(eta28-b28_3)))
p28_4DV = exp(DIS28*(eta28-b28_3))/(1+exp(DIS28*(eta28-b28_3)))

; Add a range for probability
p28_1 = min(max(p28_1DV,0.0001),0.9999)
p28_2 = min(max(p28_2DV,0.0001),0.9999)
p28_3 = min(max(p28_3DV,0.0001),0.9999)
p28_4 = min(max(p28_4DV,0.0001),0.9999)

;-------------Item 29, how would you rate overall health - reversed?---------
b29_1 = Q29th1
b29_2 = Q29th1 + Q29th2
b29_3 = Q29th1 + Q29th2 + Q29th3

p29_1DV = 1 - exp(DIS29*(eta29-b29_1))/(1+exp(DIS29*(eta29-b29_1)))
p29_2DV = exp(DIS29*(eta29-b29_1))/(1+exp(DIS29*(eta29-b29_1)))-exp(DIS29*(eta29-b29_2))/(1+exp(DIS29*(eta29-b29_2)))
p29_3DV = exp(DIS29*(eta29-b29_2))/(1+exp(DIS29*(eta29-b29_2)))-exp(DIS28*(eta29-b29_3))/(1+exp(DIS29*(eta29-b29_3)))
p29_4DV = exp(DIS28*(eta29-b29_3))/(1+exp(DIS29*(eta29-b29_3)))

; Add a range for probability
p29_1 = min(max(p29_1DV,0.0001),0.9999)
p29_2 = min(max(p29_2DV,0.0001),0.9999)
p29_3 = min(max(p29_3DV,0.0001),0.9999)
p29_4 = min(max(p29_4DV,0.0001),0.9999)

;-------------Item 30, how would you rate overall quality of life - reversed?---------

b30_1 = Q30th1
b30_2 = Q30th1 + Q30th2
b30_3 = Q30th1 + Q30th2 + Q30th3

p30_1DV = 1 - exp(DIS30*(eta30-b30_1))/(1+exp(DIS30*(eta30-b30_1)))
p30_2DV = exp(DIS30*(eta30-b30_1))/(1+exp(DIS30*(eta30-b30_1)))-exp(DIS30*(eta30-b30_2))/(1+exp(DIS30*(eta30-b30_2)))
p30_3DV = exp(DIS30*(eta30-b30_2))/(1+exp(DIS30*(eta30-b30_2)))-exp(DIS30*(eta30-b30_3))/(1+exp(DIS30*(eta30-b30_3)))
p30_4DV = exp(DIS30*(eta30-b30_3))/(1+exp(DIS30*(eta30-b30_3)))

; Add a range for probability
p30_1 = min(max(p30_1DV,0.0001),0.9999)
p30_2 = min(max(p30_2DV,0.0001),0.9999)
p30_3 = min(max(p30_3DV,0.0001),0.9999)
p30_4 = min(max(p30_4DV,0.0001),0.9999)



DEFINITION:

y1 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 1,
  P(y1=1) = p1_1
  P(y1=2) = p1_2
  P(y1=3) = p1_3
  P(y1=4) = p1_4
}

y2 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 2,
  P(y2=1) = p2_1
  P(y2=2) = p2_2
  P(y2=3) = p2_3
  P(y2=4) = p2_4
}

y3 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 3,
  P(y3=1) = p3_1
  P(y3=2) = p3_2
  P(y3=3) = p3_3
  P(y3=4) = p3_4
}


y4 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 4,
  P(y4=1) = p4_1
  P(y4=2) = p4_2
  P(y4=3) = p4_3
  P(y4=4) = p4_4
}

y5 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 5,
  P(y5=1) = p5_1
  P(y5=2) = p5_2
  P(y5=3) = p5_3
  P(y5=4) = p5_4
}

y6 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 6,
  P(y6=1) = p6_1
  P(y6=2) = p6_2
  P(y6=3) = p6_3
  P(y6=4) = p6_4
}

y7 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 7,
  P(y7=1) = p7_1
  P(y7=2) = p7_2
  P(y7=3) = p7_3
  P(y7=4) = p7_4
}

y8 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 8,
  P(y8=1) = p8_1
  P(y8=2) = p8_2
  P(y8=3) = p8_3
  P(y8=4) = p8_4
}

y9 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 9,
  P(y9=1) = p9_1
  P(y9=2) = p9_2
  P(y9=3) = p9_3
  P(y9=4) = p9_4
}

y10 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 10,
  P(y10=1) = p10_1
  P(y10=2) = p10_2
  P(y10=3) = p10_3
  P(y10=4) = p10_4
}

y11 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 11,
  P(y11=1) = p11_1
  P(y11=2) = p11_2
  P(y11=3) = p11_3
  P(y11=4) = p11_4
}

y12 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 12,
  P(y12=1) = p12_1
  P(y12=2) = p12_2
  P(y12=3) = p12_3
  P(y12=4) = p12_4
}

y13 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 13,
  P(y13=1) = p13_1
  P(y13=2) = p13_2
  P(y13=3) = p13_3
  P(y13=4) = p13_4
}

y14 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 14,
  P(y14=1) = p14_1
  P(y14=2) = p14_2
  P(y14=3) = p14_3
  P(y14=4) = p14_4
}

y15 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 15,
  P(y15=1) = p15_1
  P(y15=2) = p15_2
  P(y15=3) = p15_3
  P(y15=4) = p15_4
}

y16 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 16,
  P(y16=1) = p16_1
  P(y16=2) = p16_2
  P(y16=3) = p16_3
  P(y16=4) = p16_4
}

y17 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 17,
  P(y17=1) = p17_1
  P(y17=2) = p17_2
  P(y17=3) = p17_3
  P(y17=4) = p17_4
}

y18 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 18,
  P(y18=1) = p18_1
  P(y18=2) = p18_2
  P(y18=3) = p18_3
  P(y18=4) = p18_4
}

y19 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 19,
  P(y19=1) = p19_1
  P(y19=2) = p19_2
  P(y19=3) = p19_3
  P(y19=4) = p19_4
}

y20 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 20,
  P(y20=1) = p20_1
  P(y20=2) = p20_2
  P(y20=3) = p20_3
  P(y20=4) = p20_4
}

y21 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 21,
  P(y21=1) = p21_1
  P(y21=2) = p21_2
  P(y21=3) = p21_3
  P(y21=4) = p21_4
}

y22 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 22,
  P(y22=1) = p22_1
  P(y22=2) = p22_2
  P(y22=3) = p22_3
  P(y22=4) = p22_4
}

y23 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 23,
  P(y23=1) = p23_1
  P(y23=2) = p23_2
  P(y23=3) = p23_3
  P(y23=4) = p23_4
}

y24 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 24,
  P(y24=1) = p24_1
  P(y24=2) = p24_2
  P(y24=3) = p24_3
  P(y24=4) = p24_4
}

y25 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 25,
  P(y25=1) = p25_1
  P(y25=2) = p25_2
  P(y25=3) = p25_3
  P(y25=4) = p25_4
}

y26 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 26,
  P(y26=1) = p26_1
  P(y26=2) = p26_2
  P(y26=3) = p26_3
  P(y26=4) = p26_4
}

y27 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 27,
  P(y27=1) = p27_1
  P(y27=2) = p27_2
  P(y27=3) = p27_3
  P(y27=4) = p27_4
}

y28 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 28,
  P(y28=1) = p28_1
  P(y28=2) = p28_2
  P(y28=3) = p28_3
  P(y28=4) = p28_4
}

y29 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 29,
  P(y29=1) = p29_1
  P(y29=2) = p29_2
  P(y29=3) = p29_3
  P(y29=4) = p29_4
}

y30 = {
  type = categorical,
  categories = {1,2,3,4},
  observationID = 30,
  P(y30=1) = p30_1
  P(y30=2) = p30_2
  P(y30=3) = p30_3
  P(y30=4) = p30_4
}


OUTPUT:
output = {y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13,
y14, y15, y16, y17, y18, y19, y20, y21, y22, y23, y24, y25, y26, 
y27, y28, y29, y30}
